{
  debug
  log {
    level INFO
  }

  on_demand_tls {
    ask "http://127.0.0.1:3000/should-issue"
  }
}

benxo.test, www.benxo.test {
  tls internal

  @api path /api*
  reverse_proxy @api http://127.0.0.1:3000

  @front not path /api*
  reverse_proxy @front http://127.0.0.1:4321
}

cdn.benxo.test {
  tls internal
  reverse_proxy http://127.0.0.1:9000
}

*.mystore.benxo.test {
  tls internal
  reverse_proxy http://127.0.0.1:3000
}

*.benxo.test {
  tls internal
  respond "404 not found" 404 {
    close
  }
}

https:// {
  tls internal {
    on_demand
  }
  reverse_proxy http://127.0.0.1:3000
}
